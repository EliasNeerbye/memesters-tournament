<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Socket.IO Test</title>
    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
</head>
<body>
    <h1>Socket.IO Event Tester</h1>

    <div>
        <h2>Connection</h2>
        <button id="connect">Connect</button>
        <button id="disconnect" disabled>Disconnect</button>
        <p id="connection-status">Not connected</p>
    </div>

    <div>
        <h2>Emit Events</h2>
        <button id="emit-newGame" disabled>Emit: newGame</button>
        <button id="emit-joinGame" disabled>Emit: joinGame</button>
        <input type="text" id="joinGame-code" placeholder="Game Code">
        <button id="emit-leaveGame" disabled>Emit: leaveGame</button>
        <button id="emit-startGame" disabled>Emit: startGame</button>
        <button id="emit-finishGame" disabled>Emit: finishGame</button>
        <button id="emit-nextRound" disabled>Emit: nextRound</button>
    </div>

    <div>
        <h2>Socket Responses</h2>
        <div id="event-log" style="border: 1px solid black; padding: 10px; height: 300px; overflow-y: auto;"></div>
    </div>

    <script>
        let socket;
        const log = (type, message) => {
            const logElement = document.getElementById('event-log');
            const entry = document.createElement('p');
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${type}: ${message}`;
            logElement.appendChild(entry);
            logElement.scrollTop = logElement.scrollHeight;
        };

        const updateConnectionStatus = (status) => {
            document.getElementById('connection-status').textContent = status;
        };

        document.getElementById('connect').addEventListener('click', () => {
            socket = io('http://10.11.2.13:5000');
            log('System', 'Connecting...');
            
            socket.on('connect', () => {
                log('System', 'Connected');
                updateConnectionStatus('Connected');
                document.getElementById('disconnect').disabled = false;
                document.getElementById('emit-newGame').disabled = false;
                document.getElementById('emit-joinGame').disabled = false;
                document.getElementById('emit-leaveGame').disabled = false;
                document.getElementById('emit-startGame').disabled = false;
                document.getElementById('emit-finishGame').disabled = false;
                document.getElementById('emit-nextRound').disabled = false;
            });

            socket.on('disconnect', () => {
                log('System', 'Disconnected');
                updateConnectionStatus('Disconnected');
                document.getElementById('disconnect').disabled = true;
                document.getElementById('emit-newGame').disabled = true;
                document.getElementById('emit-joinGame').disabled = true;
                document.getElementById('emit-leaveGame').disabled = true;
                document.getElementById('emit-startGame').disabled = true;
                document.getElementById('emit-finishGame').disabled = true;
                document.getElementById('emit-nextRound').disabled = true;
            });

            // Log all incoming events
            socket.onAny((event, ...args) => {
                log(`Received: ${event}`, JSON.stringify(args));
            });
        });

        document.getElementById('disconnect').addEventListener('click', () => {
            if (socket) {
                socket.disconnect();
                log('System', 'Disconnecting...');
            }
        });

        // Emit Events
        document.getElementById('emit-newGame').addEventListener('click', () => {
            log('Emit', 'newGame');
            socket.emit('newGame');
        });

        document.getElementById('emit-joinGame').addEventListener('click', () => {
            const code = document.getElementById('joinGame-code').value;
            log('Emit', `joinGame with code: ${code}`);
            socket.emit('joinGame', code);
        });

        document.getElementById('emit-leaveGame').addEventListener('click', () => {
            log('Emit', 'leaveGame');
            socket.emit('leaveGame');
        });

        document.getElementById('emit-startGame').addEventListener('click', () => {
            log('Emit', 'startGame');
            socket.emit('startGame');
        });

        document.getElementById('emit-finishGame').addEventListener('click', () => {
            log('Emit', 'finishGame');
            socket.emit('finishGame');
        });

        document.getElementById('emit-nextRound').addEventListener('click', () => {
            log('Emit', 'nextRound');
            socket.emit('nextRound');
        });
    </script>
</body>
</html>